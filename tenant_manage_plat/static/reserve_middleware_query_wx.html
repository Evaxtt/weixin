<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="title" content="悦享源场馆预定">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<title>悦享源场馆预定</title>
	<script type="text/javascript" src="./js/jquery-2.1.4.js"></script>
</head>
<script>
	function getUrlParam(name)
	{
		var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
		var r = window.location.search.substr(1).match(reg);  //匹配目标参数
		if (r!=null) return unescape(r[2]); return null; //返回参数值
	} 
	
	
	$(function(){
	
	
	var appid = ''
	var redirect_uri = ''
			$.ajax({
					url:'/wx/get_openid_redirect_query',
					dataType:'JSON',
					data:{},
					async:false,
					success:function(result){
			        	redirect_uri = encodeURIComponent(result.redirect_uri)
			        	appid = result.appid  
			        	window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + appid + "&redirect_uri=" + redirect_uri + "&response_type=code&scope=snsapi_base&state=OK#wechat_redirect"		         
			        },
					error: function (XMLHttpRequest, textStatus, errorThrown)  {
						//alert()
						$("#test").click()
					}
				})
				
				
	})
	
	function close(){
		WeixinJSBridge.call('closeWindow');
	}
</script>
<body>
	<input type="button" id="test" value="test" onclick="WeixinJSBridge.call('closeWindow')"> 
</body>
</html>